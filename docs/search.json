[{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"make-package-functions-available","dir":"Articles","previous_headings":"","what":"Make package functions available","title":"Kangaroo distance sampling survey along roads","text":"","code":"library(densgrad)"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"acquire-data","dir":"Articles","previous_headings":"","what":"Acquire data","title":"Kangaroo distance sampling survey along roads","text":"Data come three sources: distance sampling survey (transect lengths, perpendicular distances group size) actually, random data donâ€™t appear part actual analysis GPS collar data telemetered kangaroos within truncation distance transects Make adjustments field names Actual distance sampling survey data","code":"real <- read.csv(file=\"../data/GPSpoints.txt\", header=TRUE, sep=\"\\t\") names(real) <- c(\"infid\",\"nearfid\",\"dist\",\"reserve\",\"veg\",\"animal\") survey <- read.csv(file=\"../data/nonstratified_farrar.txt\", header=TRUE, sep=\"\\t\")"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"data-munging","dir":"Articles","previous_headings":"Acquire data","what":"Data munging","title":"Kangaroo distance sampling survey along roads","text":"Transect 23 kangaroo detections, hence data perpendicular distance recorded NA. record provides information detection function needs removed purposes parameter estimation (note effort associated transects without detections need retained). Similarly, truncation distance set survey data edited accordingly.","code":"survey.truncation <- 150 gradient.max.distance <- 100 survey.data <- survey$Distance[!is.na(survey$Distance) &                                   survey$Distance<survey.truncation]"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"density-gradient-estimation","dir":"Articles","previous_headings":"","what":"Density gradient estimation","title":"Kangaroo distance sampling survey along roads","text":"Apparently optimisation really necessary, perhaps used plotting? Letâ€™s see plot fitted animal distribution respect transects (Fig. 1). Figure 1: Fitted animal density gradient.","code":"gradient <- optim(par=c(35,1.2),                   fn=likdensity,                   distances=real$dist,                   truncation=gradient.max.distance,                   control=list(fnscale=-1))#,method=\"L-BFGS-B\",lower=c(20,-100),upper=c(200,100)) if (gradient$convergence == 0) {   sigma.est <- gradient$par[1]   beta.est <- gradient$par[2]   likelihood <- gradient$value } else {   print(\"Convergence not achieved, no parameter estimates produced\") } xs <- seq(from=0, to=gradient.max.distance) par(mfrow=c(1,1),mar=c(4,4,0.5,0.5)) hist(real$dist,prob=T,main=\"\",xlab=\"Distance (m)\", nc=20) lines(xs,pi.x(xs,sigma.est,beta.est,gradient.max.distance),type=\"l\",lty=2,lwd=2)"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"joint-likelihood-estimation","dir":"Articles","previous_headings":"","what":"Joint likelihood estimation","title":"Kangaroo distance sampling survey along roads","text":"First half normal detection function Next hazard rate detection function AIC half normal detection model 52918.51 corresponding value hazard rate detection model 52919.34. Estimated parameters models: Table 1: Parameter estimates two joint models.","code":"hn.det <- optim(par=c(50,35,35),                 fn=full.lik.fx.HN,                 detectdists=survey.data,                 gpsdists=real$dist,                 truncdet=survey.truncation,                 truncden=gradient.max.distance,                 control=list(fnscale=-1))#,method=\"L-BFGS-B\",lower=c(20,-100),upper=c(200,100)) if (hn.det$convergence == 0) {   sigma.detect.est <- hn.det$par[1]   sigma.gradient.est <- hn.det$par[2]   beta.est <- hn.det$par[3]   likelihood.hn <- hn.det$value   aic.hn <- -2 * likelihood.hn + 2 * length(hn.det$par) } else {   print(\"Convergence not achieved, no parameter estimates produced\") } hz.det <- optim(par=c(50,1.2,35,35),                 fn=full.lik.fx.HR,                 detectdists=survey.data,                 gpsdists=real$dist,                 truncdet=survey.truncation,                 truncden=gradient.max.distance,                 control=list(fnscale=-1))#,method=\"L-BFGS-B\",lower=c(20,-100),upper=c(200,100)) if (hz.det$convergence == 0) {   sigma.detect.est <- hz.det$par[1]   beta.detect.est <- hz.det$par[2]   sigma.gradient.est <- hz.det$par[3]   beta.gradient.est <- hz.det$par[4]   likelihood.hz <- hz.det$value   aic.hz <- -2 * likelihood.hz + 2 * length(hz.det$par) } else {   print(\"Convergence not achieved, no parameter estimates produced\") } hn.estimates <- t(c(aic.hn, hn.det$par[1], NA, hn.det$par[2:3])) hz.estimates <- t(c(aic.hz, hz.det$par)) param.table <- as.data.frame(rbind(hn.estimates, hz.estimates)) rownames(param.table) <- c(\"Half normal\", \"Hazard rate\") colnames(param.table) <- c(\"AIC\",\"$\\\\widehat{\\\\sigma_D}$\",\"$\\\\widehat{\\\\beta_D}$\",                            \"$\\\\widehat{\\\\tau_G}$\",\"$\\\\widehat{\\\\beta_G}$\") knitr::kable(param.table, digits=1, caption=\"Parameter estimates for two joint models.\")"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"plot-of-selected-detection-function","dir":"Articles","previous_headings":"","what":"Plot of selected detection function","title":"Kangaroo distance sampling survey along roads","text":"Given (marginally) smaller AIC half normal detection function, Fig. 2 shows fit half normal detection function observed detection distances. Figure 2: Fitted half normal detection function accounting non-uniform distribution.","code":"hist(survey$Distance[survey$Distance<survey.truncation],       main=\"\",yaxt=\"n\",ylab=\"g(y)\",xlab=\"Distance (m)\") xs <- seq(from=0, to=survey.truncation) lines(xs,60*detfn(z=xs,pars=hn.det$par[1],key=\"HN\",adjn=0,w=survey.truncation),       ylab=\"g(y)\",lwd=2,type=\"l\",lty=3) axis(2,at=seq(0,60,length=5),labels=seq(0,1,length=5))"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"probability-of-detection-in-covered-region","dir":"Articles","previous_headings":"Plot of selected detection function","what":"Probability of detection in covered region","title":"Kangaroo distance sampling survey along roads","text":"Integration selected detection function perpendicular distances gives estimate detection probability (\\(\\hat{P}\\)) used adjust number detections account imperfect detectability.","code":"Phat <- estimate.Phat(\"HN\", hn.det$par, survey.truncation)"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"density-estimate-of-individuals","dir":"Articles","previous_headings":"","what":"Density estimate of individuals","title":"Kangaroo distance sampling survey along roads","text":"estimate density covered region, classic formula applied, \\[ \\hat{D} = \\frac{n \\cdot E[s]}{2wL\\hat{P}} \\] using probability detection derived best function incorporates density gradient. addition, three statistics survey required: number detections (n) total survey effort (L) average group size (E[s]) (size bias adjustment incorporated) truncation distance (w) earlier specified user. Note argument function survey data frame, including transects detections made. necessary effort (L) calculated correctly. Perpendicular distances well survey effort recorded meters. However, density estimate original paper reported numbers ha-2. conversion factor 10000 converts density m-2 ha-2. Estimated density ","code":"survey.design <- survey.design.summary(survey, survey.truncation) n <- survey.design$n L <- survey.design$L Es <- survey.design$Es Dhat <- (n * Es)/(2*survey.truncation*L*Phat)*10000"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"size-bias-adjustment-to-group-size","dir":"Articles","previous_headings":"","what":"Size bias adjustment to group size","title":"Kangaroo distance sampling survey along roads","text":"","code":"Esadj <- size.bias(\"HN\", survey.data, survey, real$dist, survey.truncation, gradient.max.distance) Dadj <- (n * Esadj)/(2*survey.truncation*L*Phat)*10000"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"point-estimate","dir":"Articles","previous_headings":"","what":"Point estimate","title":"Kangaroo distance sampling survey along roads","text":"Table 2: Summary statistics estimate density selected model.","code":"out.table <- data.frame(n=n, Es=Es, Esadj=Esadj, w=survey.truncation, L=L,                          P=Phat, D=Dhat, Dadj=Dadj) colnames(out.table) <- c(\"n\",\"E(s)\",\"$E(s)_{sb}$\",\"w\",\"L\",                          \"$\\\\hat{P}$\",\"$\\\\hat{D}$\",\"$\\\\hat{D_{sb}}$\") knitr::kable(out.table, caption=\"Summary statistics and estimate of density from selected model.\",               digits = 3)"},{"path":"https://erex.github.io/densgrad/articles/kangaroos.html","id":"variance-estimates","dir":"Articles","previous_headings":"","what":"Variance estimates","title":"Kangaroo distance sampling survey along roads","text":"bootstrap approach used variance estimation histogram estimated densities shown Fig. 3. Figure 3: Distribution bootstrap replicate estimates density. details simulation replicate saved returned first object named list, analysts can examine sampling distribution parameters estimated joint likelihood: \\(\\widehat{\\sigma_D}\\), \\(\\widehat{\\beta_D}\\) (HR), \\(\\widehat{\\sigma_G}\\), \\(\\widehat{\\beta_G}\\) well derived parameters \\(\\hat{P}\\) \\(\\hat{D}\\) (Fig. 4). Figure 4: Distribution parameter estimates via bootstrap.","code":"bounds <- varbootstrap(\"HN\", survey, real, survey.truncation, gradient.max.distance,                         Nboot=999, plotit=TRUE, alpha=0.05) knitr::kable(data.frame(LCI=signif(unname(bounds$CIbounds[1]),4),                          UCI=signif(unname(bounds$CIbounds[2]),4))) alpha <- 0.05 alphaover2 <- alpha/2 CIlimits <- c(alphaover2, 1-alphaover2) par(mfrow=c(2,2)) hist(bounds$par.estimates$sigma1, main=expression(widehat(sigma[D])), xlab=\"Estimated value\") abline(v=quantile(bounds$par.estimates$sigma1, probs = CIlimits), lwd=2, lty=3) hist(bounds$par.estimates$sigma2, main=expression(widehat(sigma[G])), xlab=\"Estimated value\") abline(v=quantile(bounds$par.estimates$sigma2, probs = CIlimits), lwd=2, lty=3) hist(bounds$par.estimates$beta, main=expression(widehat(beta[G])), xlab=\"Estimated value\") abline(v=quantile(bounds$par.estimates$beta, probs = CIlimits), lwd=2, lty=3) hist(bounds$par.estimates$P, main=expression(widehat(P)), xlab=\"Estimated value\") abline(v=quantile(bounds$par.estimates$P, probs = CIlimits), lwd=2, lty=3)"},{"path":"https://erex.github.io/densgrad/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"package proudly brought : ðŸ™ Tiago Marques. Author, maintainer. Eric Rexstad. Author.","code":""},{"path":"https://erex.github.io/densgrad/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Marques T, Rexstad E (2024). densgrad: Distance sampling presence animal gradients. R package version 0.1.5.","code":"@Manual{,   title = {densgrad: Distance sampling in presence of animal gradients},   author = {Tiago Marques and Eric Rexstad},   year = {2024},   note = {R package version 0.1.5}, }"},{"path":"https://erex.github.io/densgrad/index.html","id":"distance-sampling-in-the-presence-of-gradient-with-respect-to-transect","dir":"","previous_headings":"","what":"Distance sampling in the presence of gradient with respect to transect","title":"Distance sampling in presence of animal gradients","text":"objective repository work towards developing R package implements methods described Marques, T. ., S. T. Buckland, R. Bispo, B. Howland. 2013. Accounting animal density gradients using independent information distance sampling surveys. Statistical Methods Applications 22:67â€“80. currently pet project Eric Rexstad Tiago . Marques.","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.denom.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for CDS.HN.lik â€” CDS.HN.fx.denom","title":"Support function for CDS.HN.lik â€” CDS.HN.fx.denom","text":"called user; helper function CDS.HN.lik","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.denom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for CDS.HN.lik â€” CDS.HN.fx.denom","text":"","code":"CDS.HN.fx.denom(x, sigma1)"},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.denom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for CDS.HN.lik â€” CDS.HN.fx.denom","text":"x distances sigma1 half normal parameter","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.denom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for CDS.HN.lik â€” CDS.HN.fx.denom","text":"vector detection probabilities","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for CDS.HN.lik â€” CDS.HN.fx","title":"Support function for CDS.HN.lik â€” CDS.HN.fx","text":"called user; helper function CDS.HN.lik","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for CDS.HN.lik â€” CDS.HN.fx","text":"","code":"CDS.HN.fx(x, sigma1, w)"},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for CDS.HN.lik â€” CDS.HN.fx","text":"x distances sigma1 half normal parameter w trunction","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.fx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for CDS.HN.lik â€” CDS.HN.fx","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.lik.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of half-normal CDS detection function â€” CDS.HN.lik","title":"Likelihood of half-normal CDS detection function â€” CDS.HN.lik","text":"used conjunction optim() find MLEs sigma parameter half normal detection function","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.lik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of half-normal CDS detection function â€” CDS.HN.lik","text":"","code":"CDS.HN.lik(par, distances, truncation)"},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.lik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of half-normal CDS detection function â€” CDS.HN.lik","text":"par parameter vector optimised distances detection distances truncation truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HN.lik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of half-normal CDS detection function â€” CDS.HN.lik","text":"evaluated likelihood HN CDS","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.denom.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for CDS.HR.lik â€” CDS.HR.fx.denom","title":"Support function for CDS.HR.lik â€” CDS.HR.fx.denom","text":"called user; helper function CDS.HR.lik","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.denom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for CDS.HR.lik â€” CDS.HR.fx.denom","text":"","code":"CDS.HR.fx.denom(x, sigma1, b)"},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.denom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for CDS.HR.lik â€” CDS.HR.fx.denom","text":"x detection distances sigma1 shape parameter hazard rate b scale parameter hazard rate","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.denom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for CDS.HR.lik â€” CDS.HR.fx.denom","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for CDS.HR.lik â€” CDS.HR.fx","title":"Support function for CDS.HR.lik â€” CDS.HR.fx","text":"called user; helper function CDS.HR.lik","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for CDS.HR.lik â€” CDS.HR.fx","text":"","code":"CDS.HR.fx(x, sigma1, b, w)"},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for CDS.HR.lik â€” CDS.HR.fx","text":"x distances sigma1 shape parameter hazard rate b scale parameter hazard rate w truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.fx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for CDS.HR.lik â€” CDS.HR.fx","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.lik.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood of hazard rate CDS detection function â€” CDS.HR.lik","title":"Likelihood of hazard rate CDS detection function â€” CDS.HR.lik","text":"Likelihood hazard rate CDS detection function","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.lik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood of hazard rate CDS detection function â€” CDS.HR.lik","text":"","code":"CDS.HR.lik(par, distances, truncation)"},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.lik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood of hazard rate CDS detection function â€” CDS.HR.lik","text":"par parameters hazard rate detection function distances detection distances truncation truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/CDS.HR.lik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood of hazard rate CDS detection function â€” CDS.HR.lik","text":"evaluated likelihood HR CDS","code":""},{"path":"https://erex.github.io/densgrad/reference/detfn.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance sampling detection function â€” detfn","title":"Distance sampling detection function â€” detfn","text":"Computes probability detection given distance provided key function, adjustments parameters","code":""},{"path":"https://erex.github.io/densgrad/reference/detfn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance sampling detection function â€” detfn","text":"","code":"detfn(z, pars, key = \"HN\", adjn = 0, adjt = \"cos\", w = max(z))"},{"path":"https://erex.github.io/densgrad/reference/detfn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance sampling detection function â€” detfn","text":"z generic distance (radial perpendicular) - can scalar vector pars detection function parameter values (HN:s,adj1,adj2,...)(HR:s,b,adj1,adj2,...)(UNI:adj1,adj2,...) key detection function key, default Half Normal (HR UNI might alternatives) adjn 0, adjustment terms used, > 0, number adjustments use adjt type adjustments use, defaults cosine series w truncation distance, fundamental adjustments, default max distances","code":""},{"path":"https://erex.github.io/densgrad/reference/detfn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distance sampling detection function â€” detfn","text":"probability detection","code":""},{"path":"https://erex.github.io/densgrad/reference/estimate.Phat.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility function to estimate detection probability given joint likelihood parameter estimates â€” estimate.Phat","title":"Utility function to estimate detection probability given joint likelihood parameter estimates â€” estimate.Phat","text":"Utility function estimate detection probability given joint likelihood parameter estimates","code":""},{"path":"https://erex.github.io/densgrad/reference/estimate.Phat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility function to estimate detection probability given joint likelihood parameter estimates â€” estimate.Phat","text":"","code":"estimate.Phat(key, params, survey.truncation)"},{"path":"https://erex.github.io/densgrad/reference/estimate.Phat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utility function to estimate detection probability given joint likelihood parameter estimates â€” estimate.Phat","text":"key key function (HN HR) params estimated parameters combined likelihood either HN HR key survey.truncation truncation distance detection function","code":""},{"path":"https://erex.github.io/densgrad/reference/estimate.Phat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utility function to estimate detection probability given joint likelihood parameter estimates â€” estimate.Phat","text":"Phat estimated probability detection, integrated detection distances w","code":""},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HN.html","id":null,"dir":"Reference","previous_headings":"","what":"Combined likelihood with half normal detection and half normal gradient â€” full.lik.fx.HN","title":"Combined likelihood with half normal detection and half normal gradient â€” full.lik.fx.HN","text":"Combined likelihood half normal detection half normal gradient","code":""},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combined likelihood with half normal detection and half normal gradient â€” full.lik.fx.HN","text":"","code":"full.lik.fx.HN(par, detectdists, gpsdists, truncdet, truncden)"},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combined likelihood with half normal detection and half normal gradient â€” full.lik.fx.HN","text":"par parameters combined likelihood (sigma detection, sigma gradient, beta gradient) detectdists detection distances gpsdists distances feature collared animals truncdet truncation distance distance sampling truncden truncation distance collaring study","code":""},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combined likelihood with half normal detection and half normal gradient â€” full.lik.fx.HN","text":"value combined likelihood HN detection function","code":""},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HR.html","id":null,"dir":"Reference","previous_headings":"","what":"Combined likelihood with hazard rate detection and half normal gradient â€” full.lik.fx.HR","title":"Combined likelihood with hazard rate detection and half normal gradient â€” full.lik.fx.HR","text":"Combined likelihood hazard rate detection half normal gradient","code":""},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combined likelihood with hazard rate detection and half normal gradient â€” full.lik.fx.HR","text":"","code":"full.lik.fx.HR(par, detectdists, gpsdists, truncdet, truncden)"},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combined likelihood with hazard rate detection and half normal gradient â€” full.lik.fx.HR","text":"par four parameters combined likelihood (2 hazard rate, 2 density gradient) detectdists detection distances gpsdists distances feature collared animals truncdet truncation distance distance sampling truncden truncation distance collaring study","code":""},{"path":"https://erex.github.io/densgrad/reference/full.lik.fx.HR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combined likelihood with hazard rate detection and half normal gradient â€” full.lik.fx.HR","text":"combined likelihood evaluated HR detection function","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.denom.html","id":null,"dir":"Reference","previous_headings":"","what":"Component of combined likelihood with HN detection â€” fx.denom","title":"Component of combined likelihood with HN detection â€” fx.denom","text":"called user; support function full.lik.fx.HN","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.denom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Component of combined likelihood with HN detection â€” fx.denom","text":"","code":"fx.denom(x, sigma1, sigma2, beta, w)"},{"path":"https://erex.github.io/densgrad/reference/fx.denom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Component of combined likelihood with HN detection â€” fx.denom","text":"x detection distances sigma1 parameter half normal detection fn sigma2 parameter density gradient beta attraction/repulsion parameter density gradient w truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.denom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Component of combined likelihood with HN detection â€” fx.denom","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.denomHR.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for full.lik.fx.HR â€” fx.denomHR","title":"Support function for full.lik.fx.HR â€” fx.denomHR","text":"called user; support function full.lik.fx.HR","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.denomHR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for full.lik.fx.HR â€” fx.denomHR","text":"","code":"fx.denomHR(x, sigma1, b, sigma2, beta, w)"},{"path":"https://erex.github.io/densgrad/reference/fx.denomHR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for full.lik.fx.HR â€” fx.denomHR","text":"x detection distances sigma1 shape parameter hazard rate detection fn b scale parameter hazard rate detection fn sigma2 parameter density gradient beta attraction/repulsion parameter density gradient w truncation distance (distance sampling)","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.denomHR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for full.lik.fx.HR â€” fx.denomHR","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for full.lik.fx.HN â€” fx","title":"Support function for full.lik.fx.HN â€” fx","text":"called user; support function full.lik.fx.HN","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for full.lik.fx.HN â€” fx","text":"","code":"fx(x, sigma1, sigma2, beta, w)"},{"path":"https://erex.github.io/densgrad/reference/fx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for full.lik.fx.HN â€” fx","text":"x detection distances sigma1 parameter half normal detection fn sigma2 parameter density gradient beta attraction/repulsion parameter density gradient w truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/fx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for full.lik.fx.HN â€” fx","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/fxHR.html","id":null,"dir":"Reference","previous_headings":"","what":"Support function for full.lik.fx.HR â€” fxHR","title":"Support function for full.lik.fx.HR â€” fxHR","text":"called user; support function full.lik.fx.HR","code":""},{"path":"https://erex.github.io/densgrad/reference/fxHR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support function for full.lik.fx.HR â€” fxHR","text":"","code":"fxHR(x, sigma1, b, sigma2, beta, w)"},{"path":"https://erex.github.io/densgrad/reference/fxHR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support function for full.lik.fx.HR â€” fxHR","text":"x detection distances sigma1 shape parameter hazard rate detection fn b scale parameter hazard rate detection fn sigma2 parameter density gradient beta attraction/repulsion parameter density gradient w truncation distance (distance sampling)","code":""},{"path":"https://erex.github.io/densgrad/reference/fxHR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support function for full.lik.fx.HR â€” fxHR","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":null,"dir":"Reference","previous_headings":"","what":"Locations of telemetered animals â€” GPSpoints","title":"Locations of telemetered animals â€” GPSpoints","text":"Data derived telemetry study; required fields dist animal","code":""},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Locations of telemetered animals â€” GPSpoints","text":"","code":"data(\"GPSpoints\")"},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Locations of telemetered animals â€” GPSpoints","text":"data frame 5393 observations following 6 variables. infid numeric vector nearfid numeric vector dist numeric vector reserve factor levels Black Mt Crace Grassland Farrer Ridge Googong Gossan Hill Gungaderra Kaleen Horse Paddocks Lawson Territory Mt Ainslie Mt Majura Mt Taylor Mulanggari Oakey Hill Red Hill Wanniassa Hills veg factor levels  Forest Grassland Open Forest Open Woodland Woodland animal numeric vector animal (collar) ID","code":""},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Locations of telemetered animals â€” GPSpoints","text":"Placeholder","code":""},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Locations of telemetered animals â€” GPSpoints","text":"Marques, T. ., S. T. Buckland, R. Bispo, B. Howland. 2013. Accounting animal density gradients using independent information distance sampling surveys. Statistical Methods Applications 22:67â€“80. https://doi.org/10.1007/s10260-012-0223-2","code":""},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Locations of telemetered animals â€” GPSpoints","text":"Placeholder","code":""},{"path":"https://erex.github.io/densgrad/reference/GPSpoints.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Locations of telemetered animals â€” GPSpoints","text":"","code":"data(GPSpoints) ## maybe str(GPSpoints) ; plot(GPSpoints) ..."},{"path":"https://erex.github.io/densgrad/reference/likdensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood function to estimate parameters of the density gradient â€” likdensity","title":"Likelihood function to estimate parameters of the density gradient â€” likdensity","text":"Likelihood function estimate parameters density gradient","code":""},{"path":"https://erex.github.io/densgrad/reference/likdensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood function to estimate parameters of the density gradient â€” likdensity","text":"","code":"likdensity(par, distances, truncation)"},{"path":"https://erex.github.io/densgrad/reference/likdensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood function to estimate parameters of the density gradient â€” likdensity","text":"par parameters density gradient distances distances animal distribution transect truncation truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/likdensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood function to estimate parameters of the density gradient â€” likdensity","text":"evaluated likelihood density gradient function","code":""},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from line transect survey of kangaroos â€” nonstratified_farrar","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"Traditional line transect distance sampling data set.  Required fields Transect, Length, Distance group","code":""},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"","code":"data(\"nonstratified_farrar\")"},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"data frame 373 observations following 6 variables. Stratum factor levels Farrar Area size stratum Transect factor levels transect0 transect1 transect10 transect12 transect14 transect15 transect16 transect18 transect19 transect20 transect21 transect23 transect4 transect7 transect8 Length transect length Distance perpendicular distance transect group number individuals detected group","code":""},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"Placeholder","code":""},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"Marques, T. ., Buckland, S. T., Bispo, R., & Howland, B. (2013). Accounting animal density gradients using independent information distance sampling surveys. Statistical Methods & Applications, 22(1), 67-80. https://doi.org/10.1007/s10260-012-0223-2","code":""},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"Placeholder","code":""},{"path":"https://erex.github.io/densgrad/reference/nonstratified_farrar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Data from line transect survey of kangaroos â€” nonstratified_farrar","text":"","code":"data(nonstratified_farrar) ## maybe str(nonstratified_farrar) ; plot(nonstratified_farrar) ..."},{"path":"https://erex.github.io/densgrad/reference/pi.x.den.html","id":null,"dir":"Reference","previous_headings":"","what":"Component to modelling the density gradient â€” pi.x.den","title":"Component to modelling the density gradient â€” pi.x.den","text":"#' called user; support function likdensity","code":""},{"path":"https://erex.github.io/densgrad/reference/pi.x.den.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Component to modelling the density gradient â€” pi.x.den","text":"","code":"pi.x.den(x, sigma, beta)"},{"path":"https://erex.github.io/densgrad/reference/pi.x.den.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Component to modelling the density gradient â€” pi.x.den","text":"x perpendicular (radial) distance sigma gaussian standard deviation beta multiplicative constant, helping improve fit notice beta>0, animals avoid linear structure, beta<0, prefer ","code":""},{"path":"https://erex.github.io/densgrad/reference/pi.x.den.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Component to modelling the density gradient â€” pi.x.den","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/pi.x.html","id":null,"dir":"Reference","previous_headings":"","what":"One form of modelling the density gradient â€” pi.x","title":"One form of modelling the density gradient â€” pi.x","text":"called user; support function likdensity","code":""},{"path":"https://erex.github.io/densgrad/reference/pi.x.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"One form of modelling the density gradient â€” pi.x","text":"","code":"pi.x(x, sigma, beta, w)"},{"path":"https://erex.github.io/densgrad/reference/pi.x.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"One form of modelling the density gradient â€” pi.x","text":"x perpendicular distance sigma gaussian standard deviation beta multiplicative constant, helping improve fit notice beta>0, animals avoid linear structure, beta<0, prefer w truncation distance","code":""},{"path":"https://erex.github.io/densgrad/reference/pi.x.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"One form of modelling the density gradient â€” pi.x","text":"component likelihood","code":""},{"path":"https://erex.github.io/densgrad/reference/size.bias.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute size-bias adjusted group size estimates â€” size.bias","title":"Compute size-bias adjusted group size estimates â€” size.bias","text":"Compute size-bias adjusted group size estimates","code":""},{"path":"https://erex.github.io/densgrad/reference/size.bias.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute size-bias adjusted group size estimates â€” size.bias","text":"","code":"size.bias(key, survey.data, survey, grad.data, survey.truncation,   gradient.max.distance, plotit = FALSE)"},{"path":"https://erex.github.io/densgrad/reference/size.bias.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute size-bias adjusted group size estimates â€” size.bias","text":"key key function (HN HR) survey.data perpendicular detection distances distance sampling survey survey complete data frame distance sampling survey data grad.data animal telemetry data survey.truncation truncation distance distance sampling survey gradient.max.distance maximum distance transects telemetry data plotit flag determining plot regression scatter plot","code":""},{"path":"https://erex.github.io/densgrad/reference/size.bias.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute size-bias adjusted group size estimates â€” size.bias","text":"adjusted group size","code":""},{"path":"https://erex.github.io/densgrad/reference/survey.design.summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract information about a distance sampling survey from survey data frame â€” survey.design.summary","title":"Extract information about a distance sampling survey from survey data frame â€” survey.design.summary","text":"Extract information distance sampling survey survey data frame","code":""},{"path":"https://erex.github.io/densgrad/reference/survey.design.summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract information about a distance sampling survey from survey data frame â€” survey.design.summary","text":"","code":"survey.design.summary(survey, survey.truncation)"},{"path":"https://erex.github.io/densgrad/reference/survey.design.summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract information about a distance sampling survey from survey data frame â€” survey.design.summary","text":"survey data frame containing 'usual' distance sampling data survey.truncation truncation distance detection function fitting","code":""},{"path":"https://erex.github.io/densgrad/reference/survey.design.summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract information about a distance sampling survey from survey data frame â€” survey.design.summary","text":"named list containing number detections, survey effort average group size","code":""},{"path":"https://erex.github.io/densgrad/reference/varbootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance estimation via bootstrap over transects â€” varbootstrap","title":"Variance estimation via bootstrap over transects â€” varbootstrap","text":"Variance estimation via bootstrap transects","code":""},{"path":"https://erex.github.io/densgrad/reference/varbootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance estimation via bootstrap over transects â€” varbootstrap","text":"","code":"varbootstrap(keyfn, survey, gpsdata, disttrunc = 150,   gradientmaxdist = 100, Nboot, alpha = 0.05, plotit = TRUE,   conversion = 10000)"},{"path":"https://erex.github.io/densgrad/reference/varbootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance estimation via bootstrap over transects â€” varbootstrap","text":"keyfn key function detection function (HN HR) survey distance sampling survey data frame gpsdata animal location data frame telemetry disttrunc truncation distance distance sampling component gradientmaxdist maximum distance transect telemetry data Nboot number bootstrap replicates alpha Type error rate computing CI bounds plotit logical indicating whether produce histogram bootstrap estimates conversion conversion factor get density units reported","code":""},{"path":"https://erex.github.io/densgrad/reference/varbootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance estimation via bootstrap over transects â€” varbootstrap","text":"parameter estimates replicates upper lower confidence interval bounds individual density estimates","code":""},{"path":"https://erex.github.io/densgrad/news/index.html","id":"densgrad-015","dir":"Changelog","previous_headings":"","what":"densgrad 0.1.5","title":"densgrad 0.1.5","text":"Intermediate release new things added. example, vignette now functions includes bootstrap routine variance estimation.","code":""},{"path":"https://erex.github.io/densgrad/news/index.html","id":"new-features-0-1-5","dir":"Changelog","previous_headings":"","what":"New features","title":"densgrad 0.1.5","text":"vignette bootstrap","code":""},{"path":"https://erex.github.io/densgrad/news/index.html","id":"bug-fixes-0-1-5","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"densgrad 0.1.5","text":"none","code":""},{"path":"https://erex.github.io/densgrad/news/index.html","id":"densgrad-010","dir":"Changelog","previous_headings":"","what":"densgrad 0.1.0","title":"densgrad 0.1.0","text":"First functional version creature. developed early 2019, following work carried Tiago Marques initial set scripts, motivated 2013 paper.","code":""},{"path":"https://erex.github.io/densgrad/news/index.html","id":"new-features-0-1-0","dir":"Changelog","previous_headings":"","what":"New features","title":"densgrad 0.1.0","text":"works half normal hazard rate detection function density gradient model half normal ","code":""},{"path":"https://erex.github.io/densgrad/news/index.html","id":"bug-fixes-0-1-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"densgrad 0.1.0","text":"none fixed, likely several created","code":""}]
